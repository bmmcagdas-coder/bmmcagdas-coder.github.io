<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duyuru KaydÄ±</title>
    <!-- OneSignal v16 SDK -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignal = window.OneSignal || [];
      
      const urlParams = new URLSearchParams(window.location.search);
      const uid = urlParams.get('uid');
      const appId = urlParams.get('appid');

      OneSignal.push(async function() {
        try {
            await OneSignal.init({
                appId: appId,
                serviceWorkerPath: 'OneSignalSDKWorker.js', // DosyayÄ± doÄŸrudan iÅŸaret et
                allowLocalhostAsSecureOrigin: true
            });

            if (uid) {
                await OneSignal.login(uid);
                console.log("GiriÅŸ yapÄ±ldÄ±: " + uid);
            }

            // KÃ¼tÃ¼phanenin kendine gelmesi iÃ§in yarÄ±m saniye bekleyip kutuyu aÃ§alÄ±m
            setTimeout(() => {
                if (OneSignal.Notifications) {
                    OneSignal.Notifications.requestPermission();
                } else {
                    console.error("Notifications nesnesi yÃ¼klenemedi.");
                }
            }, 500);

        } catch (e) {
            console.error("BaÅŸlatma hatasÄ±:", e);
        }
      });
    </script>
</head>
<body style="text-align:center; font-family:sans-serif; padding:50px; background-color:#f4f4f4;">
    <div style="background:white; padding:30px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); display:inline-block; width:90%; max-width:400px;">
        <h2 style="color:#eb4d4b;">ğŸ”” Duyuru KaydÄ±</h2>
        <p id="status-text">LÃ¼tfen yukarÄ±da aÃ§Ä±lan kutucukta <b>"Ä°zin Ver"</b> butonuna basarak iÅŸlemi tamamlayÄ±n.</p>
        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
        <p style="font-size:12px; color:#999;">Kutu gelmezse sayfayÄ± yenileyiniz.</p>
        <!-- Manuel Tetikleme Butonu -->
        <button onclick="OneSignal.Notifications.requestPermission()" style="margin-top:10px; padding:10px; cursor:pointer; background:#eee; border:1px solid #ccc; border-radius:5px;">
            Kutuyu Tekrar AÃ§
        </button>
    </div>
</body>
</html>
